<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ru" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
>

<h:head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8; width=device-width; initial-scale=1"
          name="viewport"/>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
    <link rel="stylesheet" type="text/css" href="css/table.css"/>
    <link rel="stylesheet" type="text/css" href="css/canvas.css"/>
    <script type="text/javascript" src="js/validate.js"></script>
    <title>Lab 3 on Web</title>
</h:head>
<body>
<div class="container">

    <div class="image-container">
        <img src="img/lab3_web_chart.png" id="image" alt="Smth wrong"/>
    </div>

    <h:form>
        <h:outputLabel for="x" value="Value X &isin; [-3; 5]"/>
        <h:selectOneMenu name="x" styleClass="x" value="#{resultEntity.x}">
            <f:selectItem itemValue="-3" itemLabel="Item -3"/>
            <f:selectItem itemValue="-2" itemLabel="Item -2"/>
            <f:selectItem itemValue="-1" itemLabel="Item -1"/>
            <f:selectItem itemValue="0" itemLabel="Item 0"/>
            <f:selectItem itemValue="1" itemLabel="Item 1"/>
            <f:selectItem itemValue="2" itemLabel="Item 2"/>
            <f:selectItem itemValue="3" itemLabel="Item 3"/>
            <f:selectItem itemValue="4" itemLabel="Item 4"/>
            <f:selectItem itemValue="5" itemLabel="Item 5"/>
        </h:selectOneMenu>

        <h:outputLabel for="y" value="Value Y &isin; (-5; 3)"/>
        <h:inputText name="y" styleClass="y" value="#{resultEntity.y}"
                     required="true" maxlength="7"
                     requiredMessage="Value Y is required"
                     validatorMessage="The value must be from -5 to 3">
            <f:converter converterId="jakarta.faces.Float"/>
            <f:validateDoubleRange minimum="-4.9999999" maximum="2.9999999"/>
        </h:inputText>

        <h:outputLabel for="r" value="Value R &isin; [1; 4]"/>
        <h:panelGrid columns="1">
            <p:inputText id="r" name="r" styleClass="r" value="#{resultEntity.r}"/>
            <p:slider for="r" minValue="1" maxValue="4" step="0.5" onSlideEnd="handleSlideEnd(event, ui)"/>
        </h:panelGrid>

        <h:commandButton value="Send" styleClass="submit-btn">
            <f:ajax execute="@form" listener="#{resultsBean.addResult(resultEntity.x, resultEntity.y, resultEntity.r)}"
                    render="@form results-table"/>
        </h:commandButton>

    </h:form>


    <h:dataTable id="results-table" var="result" value="#{resultsBean.results}">
        <h:column>
            <f:facet name="header">
                <h:outputText value="X"/>
            </f:facet>
            <h:outputText value="#{result.x}"/>
        </h:column>
        <h:column>
            <f:facet name="header">
                <h:outputText value="Y"/>
            </f:facet>
            <h:outputText value="#{result.y}"/>
        </h:column>
        <h:column>
            <f:facet name="header">
                <h:outputText value="R"/>
            </f:facet>
            <h:outputText value="#{result.r}"/>
        </h:column>
        <h:column>
            <f:facet name="header">
                <h:outputText value="isInside"/>
            </f:facet>
            <h:outputText value="#{result.inside ? '&#10004;' : '&#10008;'}" escape="false"/>
        </h:column>
    </h:dataTable>


    <h:inputText styleClass="result-list-string" value="#{resultsBean.resultsASJSONString}"/>
    <script type="text/javascript" src="js/drawChart.js"/>
    <script type="text/javascript">
        {
            window.onload = (event) => {
                drawAllPoints();
            }
        }
    </script>



    <a href="./index.xhtml">Back to start</a>
</div>
</body>
</html>